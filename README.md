# Big_Data_Spark_SQL
### the project Architecture;
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/8e15288b-cb53-48ad-b4ed-3daebdebed28)
#### the queries are applied to the incident.csv file that containt the following data:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/c9438065-8d19-4fa5-9808-56b8d4954004)


### App1 
#### App1 Handle two queries:
* Query 1 : Count the number of incidents per service
* Code:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/a40e3134-cb01-43ae-b6bf-ec22abbc8571)

* Result:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/f6df726c-9290-4138-9b8a-43b0dafea824)

* Query 2 : Count the number of incidents per year (Show the two years where there were more incidents.)
* Code:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/9f73fcd6-654e-4bac-ac72-abfe084e8435)
* Result:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/a99f8c0d-e2ef-4347-b41e-e2d0f21ff4c5)

### App2 
#### App2 Handle three queries applyed on the following data base :
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/0398df5c-162d-42d3-beaa-b37f0ed2eb9c)
* First we gonna create this db DATABASE DB_HOPITAL and the three tables PATIENTS, MEDECINS & CONSULTATIONS using MYSQL DB;
* * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/59434b95-6550-464b-85a2-a1b373256c8a)
  * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/1f5b442f-58e3-492c-b3ff-c1ac5c72460e)
  * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/f17b7bfa-062d-42f2-ad94-217a1cf30948)
  * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/98370836-a36e-439c-8d52-f7659128ca12)
* Now  let's insert some data;
* * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/fa99a97c-7297-4633-97e0-cb065190f313)
  * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/879c525e-879c-443b-898b-d146a8dcbb4b)
  * ![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/8ab35928-b1cb-447a-99d8-cbf94fc11c35)
* Query 1 : Show the number of consultations per day:
* Code :
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/2a5c642c-5bed-45b6-98f7-14db76659965)

* Result:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/fd93b2f9-ecd3-4081-9210-46e82e3ec09b)
* Query 2 : Display the number of consultations per doctor.:
* Code :
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/5cde5228-7d61-4204-a678-4bc3adddcd64)

* Result:
![image](https://github.com/Yassine-Karimi/Big_Data_Spark_SQL/assets/66490404/f6e3f9a6-462a-4da0-9fb8-6cba5b205a03)









  


